generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Users {
  id    String @id @default(auto()) @map("_id") @db.ObjectId
  name  String
  email String @unique
}

model Products {
  id              String   @id @default(auto()) @map("_id") @db.ObjectId

  name            String
  formula         String?        // ðŸ‘ˆ optional
  price           Float
  stock           Int?           // ðŸ‘ˆ optional
  unit            String?        // ðŸ‘ˆ optional
  hazardLevel     String?        // ðŸ‘ˆ optional
  storageLocation String?        // ðŸ‘ˆ optional

  expiryDate      DateTime?
  supplier        String?
  notes           String?

  sales           Sales[]
  purchases       Purchases[]
}

model Sales {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  productId   String   @db.ObjectId
  timestamp   DateTime
  quantity    Int
  unitPrice   Float
  totalAmount Float

  product Products @relation(fields: [productId], references: [id])
}

model Purchases {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  productId String   @db.ObjectId
  timestamp DateTime
  quantity  Int
  unitCost  Float
  totalCost Float

  product Products @relation(fields: [productId], references: [id])
}

model Expenses {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  category  String
  amount    Float
  timestamp DateTime
}

model SalesSummary {
  id               String   @id @default(auto()) @map("_id") @db.ObjectId
  totalValue       Float
  changePercentage Float?
  date             DateTime
}

model PurchaseSummary {
  id               String   @id @default(auto()) @map("_id") @db.ObjectId
  totalPurchased   Float
  changePercentage Float?
  date             DateTime
}

model ExpenseSummary {
  id            String              @id @default(auto()) @map("_id") @db.ObjectId
  totalExpenses Float
  date          DateTime

  categories ExpenseByCategory[]
}

model ExpenseByCategory {
  id               String   @id @default(auto()) @map("_id") @db.ObjectId
  expenseSummaryId String   @db.ObjectId
  category         String
  amount           BigInt
  date             DateTime

  expenseSummary ExpenseSummary @relation(fields: [expenseSummaryId], references: [id])
}